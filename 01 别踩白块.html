<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <meta name="Generator" content="Sublime Text3">
    <meta name="Author" content="æ·±å±±ä¸€æ¯æŸ´">
    <meta name="website" content="http://www.lihui-v.top">
    <meta name="Description" content="é©¬ä¸åœè¹„çš„ğŸŒ!">
    <style type="text/css">
    	*{
    		margin: 0;
    		padding: 0;
    	}
    	#box {
    		width: 412px;
    		height: 500px;
    		margin: 0 auto;
    		border: 1px solid gray;
    		text-align: center;
    	}
    	/*åˆ†æ•°*/
    	.score_box {
    		height: 45px;
    		width: 100%;
    		font-size: 25px;
    		color: green;
    		text-align: center;
    	}
    	/*ç”»é¢*/
        #main{
            width: 410px;
            height: 400px;
            border: 1px solid black;
            margin: auto;
            position: relative;
            overflow: hidden;
        }
        /*å®¹å™¨*/
        #content{
            width: 100%;
            height: 400px;
            position: relative;
            top:-150px;
            left: 0;
            background: white;
        }
        /*è¡Œ*/
        .row {
        	width: 100%;
            height: 150px;
        }
        /*.å•ä¸ªçš„æ ¼å­ç›¸å½“äºå•ä¸ªçš„td*/
        .cell{
            width: 100px;
            height:150px;
            float: left;
            border: 1px solid gray;
        }
        .black{
        	width: 100px;
            height:150px;
            float: left;
            border: 1px solid gray;
            background: black;
        }
        button {
        	width: 120px;
        	height: 50px;
        	background-color: green;
        	border-radius: 5px;
        	color: white;
        	text-align: center;
        	outline: none;
        }
    </style>
</head>
<body>
    <div id="box">
    	<div class="score_box">
           åˆ†æ•°:<span id="score">0</span>
        </div>
        <div id="main">
           <div id="content"></div>
        </div>
        <button id="startBtn">å¼€å§‹æ¸¸æˆ</button>
    </div>
<script type="text/javascript">
    // é€šè¿‡IDè·å–å…ƒç´ 
	function $(id){
       return document.getElementById(id);
	}
	// åˆå§‹åŒ–æ¸¸æˆé¡µé¢
    for (var i = 0; i < 4; i++) {
    	// åˆ›å»ºè¡Œå’Œcellå‡½æ•°
    	creatEle();
    }
   
    function creatEle(){
    	// åˆ›å»ºä¸€è¡Œ
    	var newDiv = document.createElement("div");

    	newDiv.className = "row";
    	// è·å–éšæœºç±»åæ•°ç»„
    	var classNm = creatSuiji();
    	// æ¯ä¸€ä¸ªè¡Œæ”¾å››ä¸ªå…ƒç´ 
    	for (var j = 0; j < 4; j++) {
    		var cellDiv = document.createElement("div");
    		    cellDiv.className = classNm[j];
    		newDiv.appendChild(cellDiv);
    	}
    	// å¦‚æœå½“å‰æ²¡æœ‰åˆ›å»ºè¿‡rowï¼Œå°±æŠŠæ–°åˆ›å»ºçš„æ·»åŠ è¿›å»ï¼Œå¦åˆ™çš„è¯å°±æ”¾åœ¨ç¬¬ä¸€ä¸ªçš„å‰é¢
    	if($("content").firstChild == null){
                $("content").appendChild(newDiv);
            }else{
                $("content").insertBefore(newDiv,$("content").firstChild);
        }
    }
    addClick();
    function addClick(){
    	var subDiv = document.getElementsByClassName('cell');
	    for (var i = 0; i < subDiv.length; i++) {
	       	subDiv[i].onclick = function(){
	       		// ifæˆç«‹è¯´æ˜ç‚¹åˆ°çš„æ˜¯ç™½è‰²å—ï¼Œå°±è¾“äº†
	       		if (this.className.indexOf("black")==-1) {
	       			clearInterval(timer);
	                alert("æ¸¸æˆç»“æŸ");
	       		}else{
	       			this.className = "cell";
	       			this.parentNode.pass = 1;
	       			// è°ƒç”¨åŠ åˆ†å‡½æ•°
	       			addScore();
	       		}
	       	}
	    } 
    }
    var timer = null; 
    // ç‚¹å‡»å¼€å§‹æ¸¸æˆ 
    /*  é€»è¾‘ï¼š
        * è®©é»‘å¿«åŠ¨ç”»
        * è·å–containerå½“å‰topçš„å€¼ åŠ åƒç´ 
        * */
    // æ§åˆ¶æ¯æ¬¡èµ°å¤šå°‘çš„å˜é‡
    var speed = 2;
    $("startBtn").onclick = function(){
    	clearInterval(timer);
        timer = setInterval(function(){
          // è·å–å½“å‰contentçš„topä½ç½®
          var con_top = $("content").offsetTop;
          // console.log(con_top);
          if (speed+con_top>0) {
          	  con_top = 0;
          }else{
          	  con_top+=speed;
          }
          $("content").style.top = con_top + "px";
          // è¯´æ˜è¿™ä¸€è¡Œå·²ç»æ˜¾ç¤ºå®Œå…¨ï¼Œéœ€è¦æ–°åˆ›å»ºä¸€è¡Œ
          if (con_top == 0) {
              creatEle();
              addClick();
              // æ¢å¤åˆ°åˆå§‹ä½ç½®
              $("content").style.top = "-150px";
              // å°†æ˜¾ç¤ºè¿‡çš„é‚£ä¸€è¡Œåˆ é™¤
              romoveRow();
          }else if(con_top == (-150+speed)){
              var rows = $("content").childNodes;
              // console.log("+++++"+con_top,rows[rows.length-1].pass);
              // å¦‚æœå½“å‰æœ‰5è¡Œä¸”æœ€åçš„å“ªä¸€è¡Œä¸æ˜¯ç¬¬ä¸€å…³
              if((rows.length == 5) && (rows[rows.length-1].pass !== 1)){

                    clearInterval(timer);
                    alert("æ¸¸æˆç»“æŸ"+"00000000");
                }
          }
        },20);
    }
    // åŠ åˆ†å‡½æ•°
    function addScore(){
       var newScore = parseInt($("score").innerHTML)+1;
       $("score").innerHTML = newScore;
       if(newScore % 20 == 0){
                jiasu();
            }
    }
     /*
        * åˆ é™¤æœ€åä¸€è¡Œé»‘å—
        * */
    function romoveRow() {
           var con = $('content');
           // con.childNodes.length == 6æ¯æ¬¡æœ‰6è¡Œçš„æ—¶å€™å°±ä¸éœ€è¦æœ€åä¸€ä¸ªäº†
           if(con.childNodes.length == 6){
               con.removeChild(con.lastChild);
           }

    }
    // æ·»åŠ ç±»åå‡½æ•°
    function creatSuiji(){
    	 // å°†æ‰€æœ‰çš„ç±»åæ”¾å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œéšæœºäº§ç”Ÿä¸€ä¸ªä½ç½®åŠ ä¸Šblack
    	 var arr = ['cell','cell','cell','cell'];
            var num = Math.floor(Math.random()*4);
            // console.log(num);
            arr[num] = 'cell black';
            return arr;
    }
    /*
        * åŠ é€Ÿæ–¹æ³•
        * */
    function jiasu() {
            if(speed == 2){
                speed = 4;
            }else if(speed == 4){
                speed = 5;
            }else if(speed == 5){
                speed = 10;
            }else if(speed == 10){
                speed = 20;
            }else if(speed == 20){
                alert("ä½ å·²è¶…ç¥ï¼Œæµè§ˆå™¨ç©ä¸åŠ¨äº†");
            }
    }
</script>
</body>
</html>